{"k":"GoogleSheets-API","t":"Google 試算表當資料庫並取得 API","i":"2016-09-06","a":[{"e":"p","s":[{"e":"span","t":"在 Google 的雲端硬碟服務中，"},{"e":"a","attr":{"href":"https://apps.google.com/intx/zh-tw/products/sheets/","target":"_blank"},"t":"試算表"},{"e":"span","t":" 是我喜愛的樣服務之一，而在這個 Google 當道的世代相信大家也都有使用過吧！用起來就跟 "},{"e":"a","attr":{"href":"https://products.office.com/zh-tw/home","target":"_blank"},"t":"Microsoft Office"},{"e":"span","t":" 中的 "},{"e":"a","attr":{"href":"https://support.office.com/zh-tw/excel","target":"_blank"},"t":"Excel"},{"e":"span","t":" 相似，都是表格系統的文件處理，而 Google 試算表其實不只提供了 Excel 的表格功能試算外，其實也提供了多項服務，像是與"},{"e":"a","attr":{"href":"https://apps.google.com/intx/zh-TW/products/forms/","target":"_blank"},"t":"問卷表單"},{"e":"span","t":"結合，亦或者可以使用 "},{"e":"a","attr":{"href":"https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%A3","target":"_blank"},"t":"API"},{"e":"span","t":" 取得文件內容.. 等功能。"}]},{"e":"p","t":"其實要把 Google 試算表變成 API 來使用並不困難，只要做幾個設定，就可以將文件分享到網路上，甚至可以針對不同的工作表做讀取喔！以下以截圖舉例說明如何將試算表分享至網路。"},{"e":"p","s":[{"e":"span","t":"首先建立好試算表後，選取左上角的"},{"e":"b","t":"檔案"},{"e":"span","t":"，然後接著選擇"},{"e":"b","t":"發佈到網路"},{"e":"span","t":"，此時會跳出讓你選擇發佈的類型，你可以針對是否要整份文件亦或者哪個工作表做發佈，若不知道怎麼設定的話，就直接選"},{"e":"b","t":"整份文件"},{"e":"span","t":"、"},{"e":"b","t":"網頁"},{"e":"span","t":"，然後"},{"e":"b","t":"發佈"},{"e":"span","t":"吧！"}]},{"e":"p","s":[{"e":"img","attr":{"src":"https://www.ioa.tw/img/4a19175ea81c59caf1c35e31459c810f.png","alt":"點擊左上角檔案進行設定此試算表"},"s":[]}]},{"e":"p","s":[{"e":"img","attr":{"src":"https://www.ioa.tw/img/9ea09ae8e77732335c9d15acdcf6fe68.png","alt":"點擊發佈到網路"},"s":[]}]},{"e":"p","s":[{"e":"img","attr":{"src":"https://www.ioa.tw/img/47a4d2b4ceed266884c94b0d83f92eb9.png","alt":"設定要發佈的工作表以及類型"},"s":[]}]},{"e":"p","s":[{"e":"span","t":"完成發佈後，會得到一串網址，基本上我們最需要的是檔案的 key，而 key 值就在那串網址之中，以下圖為例就是 "},{"e":"code","t":"1SDK0D9UqZUpGt80BDaeC31_aTTACGthcH-KOImK42BA"},{"e":"span","t":"，這串字串很重要，要取得文件內容都得靠它！"}]},{"e":"p","s":[{"e":"img","attr":{"src":"https://www.ioa.tw/img/9077a454687cddb6c399ffdcd461ed02.png","alt":["完成發佈後，會得到一串網址，基本上我們最需要的是檔案的","key，而","key","值就在那串網址之中，這串字串很重要，要取得文件內容都得靠它"]},"s":[]}]},{"e":"p","s":[{"e":"span","t":"接著我們舉例說明如何使用，基本網址樣式有兩種(參考"},{"e":"a","attr":{"href":"https://developers.google.com/gdata/samples/spreadsheet_sample","target":"_blank"},"t":"此篇"},{"e":"span","t":")，分別如下："}]},{"e":"ul","s":[{"e":"li","s":[{"e":"a","attr":{"href":"https://spreadsheets.google.com/feeds/cells/`{key}`/`{sheet","target":"_blank"},"t":"https://spreadsheets.google.com/feeds/cells/`{key}`/`{sheet"},{"e":"span","t":" index}`/public/values"}]},{"e":"li","s":[{"e":"a","attr":{"href":"https://spreadsheets.google.com/feeds/list/`{key}`/`{sheet","target":"_blank"},"t":"https://spreadsheets.google.com/feeds/list/`{key}`/`{sheet"},{"e":"span","t":" index}`/public/values"}]}]},{"e":"p","s":[{"e":"code","t":"{key}"},{"e":"span","t":" 就是帶入剛剛提到的 key 值，而 {sheet index} 就是想取得哪一張工作表的序，若是第一張帶入 1，第二張則是 2，以此類推。另外再回傳格式的部分，預設值是 xml，若是想使用 json 的話，可以加入 "},{"e":"code","t":"?alt=json"},{"e":"span","t":" 的參數喔！"}]},{"e":"p","s":[{"e":"span","t":"下圖是針對"},{"e":"a","attr":{"href":"https://docs.google.com/spreadsheets/d/1SDK0D9UqZUpGt80BDaeC31_aTTACGthcH-KOImK42BA/edit?usp=sharing","target":"_blank"},"t":"此張試算表"},{"e":"span","t":"使用 "},{"e":"a","attr":{"href":"https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop","target":"_blank"},"t":"Postman"},{"e":"span","t":" 試著模擬呼叫第一張工作表的回傳結果，而結果會在回傳值得 "},{"e":"code","t":"feed.entry"},{"e":"span","t":" 內，格式分別就是 cells 與 list 的不同差異，下列是使用 cells 的回傳結果，其 API 網址為："},{"e":"a","attr":{"href":"https://spreadsheets.google.com/feeds/cells/1SDK0D9UqZUpGt80BDaeC31_aTTACGthcH-KOImK42BA/1/public/values?alt=json","target":"_blank"},"t":"https://spreadsheets.google.com/feeds/cells/1SDK0D9UqZUpGt80BDaeC31_aTTACGthcH-KOImK42BA/1/public/values?alt=json"}]},{"e":"p","s":[{"e":"img","attr":{"src":"https://www.ioa.tw/img/cd1cf72321e82420bdbd0ce424a7a5d0.png","alt":"此網站的試算表內容"},"s":[]}]},{"e":"p","s":[{"e":"img","attr":{"src":"https://www.ioa.tw/img/24c8c609128c73eebf6daec6a1b0fbb4.png","alt":["以","Postman","呼叫完後的","json","結果"]},"s":[]}]},{"e":"p","s":[{"e":"img","attr":{"src":"https://www.ioa.tw/img/81f296edcbcb2cf5c84f4db2b380cabc.png","alt":["在使用","cells","方式回傳後，可以發現取得到對應表格的","row","與","col","的值"]},"s":[]}]}],"r":[{"e":"ul","s":[{"e":"li","s":[{"e":"a","attr":{"href":"https://developers.google.com/gdata/samples/spreadsheet_sample","target":"_blank"},"t":"Simple example of retrieving JSON feeds from Spreadsheets Data API.."}]},{"e":"li","s":[{"e":"a","attr":{"href":"http://www.kamira.co.vu/2012/11/jquery-google-spreadsheet.html","target":"_blank"},"t":"拉普菲斯: jQuery | 利用 Google Spreadsheet 作資料庫"}]},{"e":"li","s":[{"e":"a","attr":{"href":"http://www.wfublog.com/2011/11/google-spreadsheet-as-micro-database-1.html","target":"_blank"},"t":"利用 Google 問卷(試算表)當小型資料庫.."}]}]}],"g":["Google sheets","API"]}